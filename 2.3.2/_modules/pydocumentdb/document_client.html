
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pydocumentdb.document_client &#8212; pydocumentdb 2.3.1 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pydocumentdb 2.3.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pydocumentdb.document_client</h1><div class="highlight"><pre>
<span></span><span class="c1">#The MIT License (MIT)</span>
<span class="c1">#Copyright (c) 2014 Microsoft Corporation</span>

<span class="c1">#Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1">#of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1">#in the Software without restriction, including without limitation the rights</span>
<span class="c1">#to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1">#copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1">#furnished to do so, subject to the following conditions:</span>

<span class="c1">#The above copyright notice and this permission notice shall be included in all</span>
<span class="c1">#copies or substantial portions of the Software.</span>

<span class="c1">#THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1">#IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1">#FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1">#AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1">#LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1">#OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="c1">#SOFTWARE.</span>

<span class="sd">&quot;&quot;&quot;Document client class for the Azure Cosmos DB database service.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.base</span> <span class="k">as</span> <span class="nn">base</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.documents</span> <span class="k">as</span> <span class="nn">documents</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.constants</span> <span class="k">as</span> <span class="nn">constants</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.http_constants</span> <span class="k">as</span> <span class="nn">http_constants</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.query_iterable</span> <span class="k">as</span> <span class="nn">query_iterable</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.runtime_constants</span> <span class="k">as</span> <span class="nn">runtime_constants</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.synchronized_request</span> <span class="k">as</span> <span class="nn">synchronized_request</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.global_endpoint_manager</span> <span class="k">as</span> <span class="nn">global_endpoint_manager</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.routing.routing_map_provider</span> <span class="k">as</span> <span class="nn">routing_map_provider</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.session</span> <span class="k">as</span> <span class="nn">session</span>
<span class="kn">import</span> <span class="nn">pydocumentdb.utils</span> <span class="k">as</span> <span class="nn">utils</span>

<div class="viewcode-block" id="DocumentClient"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient">[docs]</a><span class="k">class</span> <span class="nc">DocumentClient</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a document client.</span>

<span class="sd">    Provides a client-side logical representation of the Azure Cosmos DB</span>
<span class="sd">    service. This client is used to configure and execute requests against the</span>
<span class="sd">    service.</span>

<span class="sd">    The service client encapsulates the endpoint and credentials used to access</span>
<span class="sd">    the Azure Cosmos DB service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">_QueryCompatibilityMode</span><span class="p">:</span>
        <span class="n">Default</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Query</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">SqlQuery</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="c1"># default number precisions</span>
    <span class="n">_DefaultNumberHashPrecision</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">_DefaultNumberRangePrecision</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1"># default string precision</span>
    <span class="n">_DefaultStringHashPrecision</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">_DefaultStringRangePrecision</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">url_connection</span><span class="p">,</span>
                 <span class="n">auth</span><span class="p">,</span>
                 <span class="n">connection_policy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">consistency_level</span><span class="o">=</span><span class="n">documents</span><span class="o">.</span><span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">Session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param str url_connection:</span>
<span class="sd">            The URL for connecting to the DB server.</span>
<span class="sd">        :param dict auth:</span>
<span class="sd">            Contains &#39;masterKey&#39; or &#39;resourceTokens&#39;, where</span>
<span class="sd">            auth[&#39;masterKey&#39;] is the default authorization key to use to</span>
<span class="sd">            create the client, and auth[&#39;resourceTokens&#39;] is the alternative</span>
<span class="sd">            authorization key.</span>
<span class="sd">        :param documents.ConnectionPolicy connection_policy:</span>
<span class="sd">            The connection policy for the client.</span>
<span class="sd">        :param documents.ConsistencyLevel consistency_level:</span>
<span class="sd">            The default consistency policy for client operations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url_connection</span> <span class="o">=</span> <span class="n">url_connection</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">master_key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource_tokens</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">auth</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master_key</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;masterKey&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource_tokens</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resourceTokens&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">auth</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;permissionFeed&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resource_tokens</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">permission_feed</span> <span class="ow">in</span> <span class="n">auth</span><span class="p">[</span><span class="s1">&#39;permissionFeed&#39;</span><span class="p">]:</span>
                    <span class="n">resource_parts</span> <span class="o">=</span> <span class="n">permission_feed</span><span class="p">[</span><span class="s1">&#39;resource&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="n">resource_parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resource_tokens</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">permission_feed</span><span class="p">[</span><span class="s1">&#39;_token&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connection_policy</span> <span class="o">=</span> <span class="p">(</span><span class="n">connection_policy</span> <span class="ow">or</span>
                                  <span class="n">documents</span><span class="o">.</span><span class="n">ConnectionPolicy</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">partition_resolvers</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">partition_key_definition_cache</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">CacheControl</span><span class="p">:</span> <span class="s1">&#39;no-cache&#39;</span><span class="p">,</span>
            <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">Version</span><span class="p">:</span>
                <span class="n">http_constants</span><span class="o">.</span><span class="n">Versions</span><span class="o">.</span><span class="n">CurrentVersion</span><span class="p">,</span>
            <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">UserAgent</span><span class="p">:</span>
                <span class="n">utils</span><span class="o">.</span><span class="n">_get_user_agent</span><span class="p">(),</span>
            <span class="c1"># For single partition query with aggregate functions we would try to accumulate the results on the SDK.</span>
            <span class="c1"># We need to set continuation as not expected.</span>
            <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">IsContinuationExpected</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">consistency_level</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span><span class="p">[</span>
                <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ConsistencyLevel</span><span class="p">]</span> <span class="o">=</span> <span class="n">consistency_level</span>

        <span class="c1"># Keeps the latest response headers from server.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">consistency_level</span> <span class="o">==</span> <span class="n">documents</span><span class="o">.</span><span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">Session</span><span class="p">:</span>
            <span class="sd">&#39;&#39;&#39;create a session - this is maintained only if the default consistency level</span>
<span class="sd">            on the client is set to session, or if the user explicitly sets it as a property</span>
<span class="sd">            via setter&#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url_connection</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span> <span class="o">=</span> <span class="n">global_endpoint_manager</span><span class="o">.</span><span class="n">_GlobalEndpointManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># creating a requests session used for connection pooling and re-used by all requests</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_requests_session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

        <span class="c1"># Query compatibility mode.</span>
        <span class="c1"># Allows to specify compatibility mode used by client when making query requests. Should be removed when</span>
        <span class="c1"># application/sql is no longer supported.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_query_compatibility_mode</span> <span class="o">=</span> <span class="n">DocumentClient</span><span class="o">.</span><span class="n">_QueryCompatibilityMode</span><span class="o">.</span><span class="n">Default</span>

        <span class="c1"># Routing map provider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_routing_map_provider</span> <span class="o">=</span> <span class="n">routing_map_provider</span><span class="o">.</span><span class="n">_SmartRoutingMapProvider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Session</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Gets the session object from the client &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span>

    <span class="nd">@Session</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">Session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets a session object on the document client</span>
<span class="sd">            This will override the existing session</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">session</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">WriteEndpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the curent write endpoint for a geo-replicated database account.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ReadEndpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the curent read endpoint for a geo-replicated database account.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">ReadEndpoint</span>

<div class="viewcode-block" id="DocumentClient.RegisterPartitionResolver"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.RegisterPartitionResolver">[docs]</a>    <span class="k">def</span> <span class="nf">RegisterPartitionResolver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">partition_resolver</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Registers the partition resolver associated with the database link</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            Database Self Link or ID based link.</span>
<span class="sd">        :param object partition_resolver:</span>
<span class="sd">            An instance of PartitionResolver.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">database_link</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;database_link is None or empty.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">partition_resolver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;partition_resolver is None.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">partition_resolvers</span> <span class="o">=</span> <span class="p">{</span><span class="n">base</span><span class="o">.</span><span class="n">TrimBeginningAndEndingSlashes</span><span class="p">(</span><span class="n">database_link</span><span class="p">):</span> <span class="n">partition_resolver</span><span class="p">}</span></div>


<div class="viewcode-block" id="DocumentClient.GetPartitionResolver"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.GetPartitionResolver">[docs]</a>    <span class="k">def</span> <span class="nf">GetPartitionResolver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the partition resolver associated with the database link</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            Database self link or ID based link.</span>

<span class="sd">        :return:</span>
<span class="sd">            An instance of PartitionResolver.</span>
<span class="sd">        :rtype: object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">database_link</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;database_link is None or empty.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">partition_resolvers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">TrimBeginningAndEndingSlashes</span><span class="p">(</span><span class="n">database_link</span><span class="p">))</span></div>

        
<div class="viewcode-block" id="DocumentClient.CreateDatabase"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateDatabase">[docs]</a>    <span class="k">def</span> <span class="nf">CreateDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a database.</span>

<span class="sd">        :param dict database:</span>
<span class="sd">            The Azure Cosmos DB database to create.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The Database that was created.</span>
<span class="sd">        :rtype: dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/dbs&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="s1">&#39;dbs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadDatabase"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadDatabase">[docs]</a>    <span class="k">def</span> <span class="nf">ReadDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a database.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The Database that was read.</span>
<span class="sd">        :rtype: dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="n">database_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;dbs&#39;</span><span class="p">,</span> <span class="n">database_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadDatabases"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadDatabases">[docs]</a>    <span class="k">def</span> <span class="nf">ReadDatabases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all databases.</span>

<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return: </span>
<span class="sd">            Query Iterable of Databases.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryDatabases</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryDatabases"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryDatabases">[docs]</a>    <span class="k">def</span> <span class="nf">QueryDatabases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries databases.</span>

<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return: Query Iterable of Databases.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="s1">&#39;/dbs&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;dbs&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Databases&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadCollections"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadCollections">[docs]</a>    <span class="k">def</span> <span class="nf">ReadCollections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all collections in a database.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>
<span class="sd">            </span>
<span class="sd">        :return: Query Iterable of Collections.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryCollections</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryCollections"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryCollections">[docs]</a>    <span class="k">def</span> <span class="nf">QueryCollections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries collections in a database.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return: Query Iterable of Collections.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="s1">&#39;colls&#39;</span><span class="p">)</span>
        <span class="n">database_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;colls&#39;</span><span class="p">,</span>
                                    <span class="n">database_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;DocumentCollections&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">body</span><span class="p">:</span> <span class="n">body</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.CreateCollection"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateCollection">[docs]</a>    <span class="k">def</span> <span class="nf">CreateCollection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a collection in a database.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param dict collection:</span>
<span class="sd">            The Azure Cosmos DB collection to create.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return: The Collection that was created.</span>
<span class="sd">        :rtype: dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="s1">&#39;colls&#39;</span><span class="p">)</span>
        <span class="n">database_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;colls&#39;</span><span class="p">,</span>
                           <span class="n">database_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceCollection"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceCollection">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceCollection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a collection and return it.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the collection entity.</span>
<span class="sd">        :param dict collection: </span>
<span class="sd">            The collection to be used.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The new Collection.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;colls&#39;</span><span class="p">,</span>
                            <span class="n">collection_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadCollection"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadCollection">[docs]</a>    <span class="k">def</span> <span class="nf">ReadCollection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Collection.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                         <span class="s1">&#39;colls&#39;</span><span class="p">,</span>
                         <span class="n">collection_id</span><span class="p">,</span>
                         <span class="kc">None</span><span class="p">,</span>
                         <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.CreateUser"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateUser">[docs]</a>    <span class="k">def</span> <span class="nf">CreateUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a user.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param dict user:</span>
<span class="sd">            The Azure Cosmos DB user to create.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created User.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">database_id</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetDatabaseIdWithPathForUser</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">user</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;users&#39;</span><span class="p">,</span>
                           <span class="n">database_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertUser"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertUser">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts a user.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param dict user:</span>
<span class="sd">            The Azure Cosmos DB user to upsert.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted User.</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">database_id</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetDatabaseIdWithPathForUser</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">user</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;users&#39;</span><span class="p">,</span>
                           <span class="n">database_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_GetDatabaseIdWithPathForUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="s1">&#39;users&#39;</span><span class="p">)</span>
        <span class="n">database_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">database_id</span><span class="p">,</span> <span class="n">path</span>
    

<div class="viewcode-block" id="DocumentClient.ReadUser"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadUser">[docs]</a>    <span class="k">def</span> <span class="nf">ReadUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a user.</span>

<span class="sd">        :param str user_link:</span>
<span class="sd">            The link to the user entity.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read User.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadUsers"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadUsers">[docs]</a>    <span class="k">def</span> <span class="nf">ReadUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all users in a database.</span>

<span class="sd">        :params str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :params dict options:</span>
<span class="sd">            The request options for the request.</span>
<span class="sd">        :return:</span>
<span class="sd">            Query iterable of Users.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryUsers</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryUsers"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryUsers">[docs]</a>    <span class="k">def</span> <span class="nf">QueryUsers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries users in a database.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Users.</span>
<span class="sd">        :rtype:   </span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">,</span> <span class="s1">&#39;users&#39;</span><span class="p">)</span>
        <span class="n">database_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;users&#39;</span><span class="p">,</span>
                                    <span class="n">database_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Users&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteDatabase"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteDatabase">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a database.</span>

<span class="sd">        :param str database_link:</span>
<span class="sd">            The link to the database.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Database.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="n">database_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">database_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;dbs&#39;</span><span class="p">,</span>
                                   <span class="n">database_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.CreatePermission"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreatePermission">[docs]</a>    <span class="k">def</span> <span class="nf">CreatePermission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_link</span><span class="p">,</span> <span class="n">permission</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a permission for a user.</span>

<span class="sd">        :param str user_link:</span>
<span class="sd">            The link to the user entity.</span>
<span class="sd">        :param dict permission:</span>
<span class="sd">            The Azure Cosmos DB user permission to create.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created Permission.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span><span class="p">,</span> <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetUserIdWithPathForPermission</span><span class="p">(</span><span class="n">permission</span><span class="p">,</span> <span class="n">user_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">permission</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;permissions&#39;</span><span class="p">,</span>
                           <span class="n">user_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertPermission"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertPermission">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertPermission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_link</span><span class="p">,</span> <span class="n">permission</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts a permission for a user.</span>

<span class="sd">        :param str user_link:</span>
<span class="sd">            The link to the user entity.</span>
<span class="sd">        :param dict permission:</span>
<span class="sd">            The Azure Cosmos DB user permission to upsert.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted permission.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span><span class="p">,</span> <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetUserIdWithPathForPermission</span><span class="p">(</span><span class="n">permission</span><span class="p">,</span> <span class="n">user_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">permission</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;permissions&#39;</span><span class="p">,</span>
                            <span class="n">user_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_GetUserIdWithPathForPermission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permission</span><span class="p">,</span> <span class="n">user_link</span><span class="p">):</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">permission</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">,</span> <span class="s1">&#39;permissions&#39;</span><span class="p">)</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="n">user_id</span>


<div class="viewcode-block" id="DocumentClient.ReadPermission"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadPermission">[docs]</a>    <span class="k">def</span> <span class="nf">ReadPermission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permission_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a permission.</span>

<span class="sd">        :param str permission_link:</span>
<span class="sd">            The link to the permission.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read permission.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">permission_link</span><span class="p">)</span>
        <span class="n">permission_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">permission_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                         <span class="s1">&#39;permissions&#39;</span><span class="p">,</span>
                          <span class="n">permission_id</span><span class="p">,</span>
                          <span class="kc">None</span><span class="p">,</span>
                          <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadPermissions"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadPermissions">[docs]</a>    <span class="k">def</span> <span class="nf">ReadPermissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all permissions for a user.</span>

<span class="sd">        :param str user_link:</span>
<span class="sd">            The link to the user entity.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Permissions.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryPermissions</span><span class="p">(</span><span class="n">user_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryPermissions"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryPermissions">[docs]</a>    <span class="k">def</span> <span class="nf">QueryPermissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries permissions for a user.</span>

<span class="sd">        :param str user_link:</span>
<span class="sd">            The link to the user entity.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Permissions.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">,</span> <span class="s1">&#39;permissions&#39;</span><span class="p">)</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;permissions&#39;</span><span class="p">,</span>
                                    <span class="n">user_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Permissions&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceUser"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceUser">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_link</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a user and return it.</span>

<span class="sd">        :param str user_link:</span>
<span class="sd">            The link to the user entity.</span>
<span class="sd">        :param dict user:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The new User.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">user</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;users&#39;</span><span class="p">,</span>
                            <span class="n">user_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteUser"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteUser">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a user.</span>

<span class="sd">        :param str user_link:</span>
<span class="sd">            The link to the user entity.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted user.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">user_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;users&#39;</span><span class="p">,</span>
                                   <span class="n">user_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReplacePermission"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplacePermission">[docs]</a>    <span class="k">def</span> <span class="nf">ReplacePermission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permission_link</span><span class="p">,</span> <span class="n">permission</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a permission and return it.</span>

<span class="sd">        :param str permission_link:</span>
<span class="sd">            The link to the permission.</span>
<span class="sd">        :param dict permission:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The new Permission.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">permission</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">permission_link</span><span class="p">)</span>
        <span class="n">permission_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">permission_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">permission</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;permissions&#39;</span><span class="p">,</span>
                            <span class="n">permission_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeletePermission"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeletePermission">[docs]</a>    <span class="k">def</span> <span class="nf">DeletePermission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permission_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a permission.</span>

<span class="sd">        :param str permission_link:</span>
<span class="sd">            The link to the permission.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Permission.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">permission_link</span><span class="p">)</span>
        <span class="n">permission_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">permission_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;permissions&#39;</span><span class="p">,</span>
                                   <span class="n">permission_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadDocuments"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadDocuments">[docs]</a>    <span class="k">def</span> <span class="nf">ReadDocuments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">feed_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all documents in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict feed_options:</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Documents.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">feed_options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">feed_options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryDocuments</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">feed_options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryDocuments"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryDocuments">[docs]</a>    <span class="k">def</span> <span class="nf">QueryDocuments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">partition_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries documents in a collection.</span>

<span class="sd">        :param str database_or_collection_link:</span>
<span class="sd">            The link to the database when using partitioning, otherwise link to the document collection.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>
<span class="sd">        :param str partition_key:</span>
<span class="sd">            Partition key for the query(default value None)</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Documents.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">database_or_collection_link</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">TrimBeginningAndEndingSlashes</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">IsDatabaseLink</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">)):</span>
            <span class="c1"># Python doesn&#39;t have a good way of specifying an overloaded constructor, and this is how it&#39;s generally overloaded constructors are specified(by calling a @classmethod) and returning the &#39;self&#39; instance</span>
            <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="o">.</span><span class="n">PartitioningQueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">partition_key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>    
            <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">,</span> <span class="s1">&#39;docs&#39;</span><span class="p">)</span>
            <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                        <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                                        <span class="n">collection_id</span><span class="p">,</span>
                                        <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Documents&#39;</span><span class="p">],</span>
                                        <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                        <span class="n">query</span><span class="p">,</span>
                                        <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
            <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">,</span> <span class="n">database_or_collection_link</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_ReadPartitionKeyRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">feed_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads Partition Key Ranges.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict feed_options:</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of PartitionKeyRanges.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">feed_options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">feed_options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_QueryPartitionKeyRanges</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">feed_options</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_QueryPartitionKeyRanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries Partition Key Ranges in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of PartitionKeyRanges.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;pkranges&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;pkranges&#39;</span><span class="p">,</span>
                                    <span class="n">collection_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;PartitionKeyRanges&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span>

<div class="viewcode-block" id="DocumentClient.CreateDocument"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateDocument">[docs]</a>    <span class="k">def</span> <span class="nf">CreateDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a document in a collection.</span>

<span class="sd">        :param str database_or_collection_link:</span>
<span class="sd">            The link to the database when using partitioning, otherwise link to the document collection.</span>
<span class="sd">        :param dict document:</span>
<span class="sd">            The Azure Cosmos DB document to create.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>
<span class="sd">        :param bool options[&#39;disableAutomaticIdGeneration&#39;]:</span>
<span class="sd">            Disables the automatic id generation. If id is missing in the body and this</span>
<span class="sd">            option is true, an error will be returned.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created Document.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Pythons default arguments are evaluated once when the function is defined, not each time the function is called (like it is in say, Ruby). </span>
        <span class="c1"># This means that if you use a mutable default argument and mutate it, you will and have mutated that object for all future calls to the function as well.</span>
        <span class="c1"># So, using a non-mutable deafult in this case(None) and assigning an empty dict(mutable) inside the method</span>
        <span class="c1"># For more details on this gotcha, please refer http://docs.python-guide.org/en/latest/writing/gotchas/</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># We check the link to be document collection link since it can be database link in case of client side partitioning</span>
        <span class="k">if</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">IsDocumentCollectionLink</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">)):</span>
            <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AddPartitionKey</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForDocument</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">document</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertDocument"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertDocument">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts a document in a collection.</span>

<span class="sd">        :param str database_or_collection_link:</span>
<span class="sd">            The link to the database when using partitioning, otherwise link to the document collection.</span>
<span class="sd">        :param dict document:</span>
<span class="sd">            The Azure Cosmos DB document to upsert.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>
<span class="sd">        :param bool options[&#39;disableAutomaticIdGeneration&#39;]:</span>
<span class="sd">            Disables the automatic id generation. If id is missing in the body and this</span>
<span class="sd">            option is true, an error will be returned.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted Document.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Pythons default arguments are evaluated once when the function is defined, not each time the function is called (like it is in say, Ruby). </span>
        <span class="c1"># This means that if you use a mutable default argument and mutate it, you will and have mutated that object for all future calls to the function as well.</span>
        <span class="c1"># So, using a non-mutable deafult in this case(None) and assigning an empty dict(mutable) inside the method</span>
        <span class="c1"># For more details on this gotcha, please refer http://docs.python-guide.org/en/latest/writing/gotchas/</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># We check the link to be document collection link since it can be database link in case of client side partitioning</span>
        <span class="k">if</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">IsDocumentCollectionLink</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">)):</span>
            <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AddPartitionKey</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForDocument</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">document</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

    <span class="n">PartitionResolverErrorMessage</span> <span class="o">=</span> <span class="s2">&quot;Couldn&#39;t find any partition resolvers for the database link provided. Ensure that the link you used when registering the partition resolvers matches the link provided or you need to register both types of database link(self link as well as ID based link).&quot;</span>

    <span class="c1"># Gets the collection id and path for the document</span>
    <span class="k">def</span> <span class="nf">_GetCollectionIdWithPathForDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database_or_collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">database_or_collection_link</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;database_or_collection_link is None or empty.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">document</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;document is None.&quot;</span><span class="p">)</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
        <span class="n">document</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">document</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="ow">and</span>
            <span class="ow">not</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;disableAutomaticIdGeneration&#39;</span><span class="p">)):</span>
            <span class="n">document</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GenerateGuidId</span><span class="p">()</span>
        
        <span class="n">collection_link</span> <span class="o">=</span> <span class="n">database_or_collection_link</span>

        <span class="k">if</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">IsDatabaseLink</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">)):</span>
            <span class="n">partition_resolver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPartitionResolver</span><span class="p">(</span><span class="n">database_or_collection_link</span><span class="p">)</span>
        
            <span class="k">if</span><span class="p">(</span><span class="n">partition_resolver</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">collection_link</span> <span class="o">=</span> <span class="n">partition_resolver</span><span class="o">.</span><span class="n">ResolveForCreate</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">DocumentClient</span><span class="o">.</span><span class="n">PartitionResolverErrorMessage</span><span class="p">)</span>
        
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;docs&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">path</span>
    
<div class="viewcode-block" id="DocumentClient.ReadDocument"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadDocument">[docs]</a>    <span class="k">def</span> <span class="nf">ReadDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a document.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Document.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="n">document_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                         <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                         <span class="n">document_id</span><span class="p">,</span>
                         <span class="kc">None</span><span class="p">,</span>
                         <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadTriggers"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadTriggers">[docs]</a>    <span class="k">def</span> <span class="nf">ReadTriggers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all triggers in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Triggers.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryTriggers</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryTriggers"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryTriggers">[docs]</a>    <span class="k">def</span> <span class="nf">QueryTriggers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries triggers in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Triggers.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;triggers&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;triggers&#39;</span><span class="p">,</span>
                                    <span class="n">collection_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Triggers&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.CreateTrigger"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateTrigger">[docs]</a>    <span class="k">def</span> <span class="nf">CreateTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">trigger</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a trigger in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict trigger:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created Trigger.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForTrigger</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="n">trigger</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">trigger</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;triggers&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertTrigger"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertTrigger">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">trigger</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts a trigger in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict trigger:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted Trigger.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForTrigger</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="n">trigger</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">trigger</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;triggers&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_GetCollectionIdWithPathForTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span>
        <span class="n">trigger</span> <span class="o">=</span> <span class="n">trigger</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span>  <span class="n">trigger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">):</span>
            <span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">trigger</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">trigger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">):</span>
            <span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">])</span>
        
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;triggers&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">trigger</span>
    

<div class="viewcode-block" id="DocumentClient.ReadTrigger"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadTrigger">[docs]</a>    <span class="k">def</span> <span class="nf">ReadTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a trigger.</span>

<span class="sd">        :param str trigger_link:</span>
<span class="sd">            The link to the trigger.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Trigger.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">trigger_link</span><span class="p">)</span>
        <span class="n">trigger_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">trigger_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;triggers&#39;</span><span class="p">,</span> <span class="n">trigger_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadUserDefinedFunctions"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadUserDefinedFunctions">[docs]</a>    <span class="k">def</span> <span class="nf">ReadUserDefinedFunctions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all user defined functions in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of UDFs.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryUserDefinedFunctions</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryUserDefinedFunctions"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryUserDefinedFunctions">[docs]</a>    <span class="k">def</span> <span class="nf">QueryUserDefinedFunctions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries user defined functions in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the collection.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of UDFs.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;udfs&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;udfs&#39;</span><span class="p">,</span>
                                    <span class="n">collection_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;UserDefinedFunctions&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.CreateUserDefinedFunction"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateUserDefinedFunction">[docs]</a>    <span class="k">def</span> <span class="nf">CreateUserDefinedFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">udf</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a user defined function in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the collection.</span>
<span class="sd">        :param str udf:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created UDF.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">udf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForUDF</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="n">udf</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">udf</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;udfs&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertUserDefinedFunction"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertUserDefinedFunction">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertUserDefinedFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">udf</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts a user defined function in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the collection.</span>
<span class="sd">        :param str udf:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted UDF.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">udf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForUDF</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="n">udf</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">udf</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;udfs&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_GetCollectionIdWithPathForUDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">udf</span><span class="p">):</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">udf</span><span class="p">)</span>
        <span class="n">udf</span> <span class="o">=</span> <span class="n">udf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">udf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">):</span>
            <span class="n">udf</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">udf</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">udf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">):</span>
            <span class="n">udf</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">udf</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">])</span>
        
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;udfs&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">udf</span>
    

<div class="viewcode-block" id="DocumentClient.ReadUserDefinedFunction"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadUserDefinedFunction">[docs]</a>    <span class="k">def</span> <span class="nf">ReadUserDefinedFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">udf_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a user defined function.</span>

<span class="sd">        :param str udf_link:</span>
<span class="sd">            The link to the user defined function.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read UDF.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">udf_link</span><span class="p">)</span>
        <span class="n">udf_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">udf_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;udfs&#39;</span><span class="p">,</span> <span class="n">udf_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadStoredProcedures"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadStoredProcedures">[docs]</a>    <span class="k">def</span> <span class="nf">ReadStoredProcedures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all store procedures in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Stored Procedures.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryStoredProcedures</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryStoredProcedures"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryStoredProcedures">[docs]</a>    <span class="k">def</span> <span class="nf">QueryStoredProcedures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries stored procedures in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Stored Procedures.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;sprocs&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;sprocs&#39;</span><span class="p">,</span>
                                    <span class="n">collection_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;StoredProcedures&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.CreateStoredProcedure"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateStoredProcedure">[docs]</a>    <span class="k">def</span> <span class="nf">CreateStoredProcedure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">sproc</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a stored procedure in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param str sproc:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created Stored Procedure.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">sproc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForSproc</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="n">sproc</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">sproc</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;sprocs&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertStoredProcedure"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertStoredProcedure">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertStoredProcedure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">sproc</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts a stored procedure in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param str sproc:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted Stored Procedure.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">sproc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetCollectionIdWithPathForSproc</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="n">sproc</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">sproc</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;sprocs&#39;</span><span class="p">,</span>
                           <span class="n">collection_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_GetCollectionIdWithPathForSproc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">sproc</span><span class="p">):</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">sproc</span><span class="p">)</span>
        <span class="n">sproc</span> <span class="o">=</span> <span class="n">sproc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sproc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">):</span>
            <span class="n">sproc</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sproc</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">sproc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">):</span>
            <span class="n">sproc</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sproc</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">])</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;sprocs&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">sproc</span>
    

<div class="viewcode-block" id="DocumentClient.ReadStoredProcedure"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadStoredProcedure">[docs]</a>    <span class="k">def</span> <span class="nf">ReadStoredProcedure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sproc_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a stored procedure.</span>

<span class="sd">        :param str sproc_link:</span>
<span class="sd">            The link to the stored procedure.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Stored Procedure.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="n">sproc_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;sprocs&#39;</span><span class="p">,</span> <span class="n">sproc_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadConflicts"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadConflicts">[docs]</a>    <span class="k">def</span> <span class="nf">ReadConflicts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">feed_options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads conflicts.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict feed_options:</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Conflicts.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">feed_options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">feed_options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryConflicts</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">feed_options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryConflicts"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryConflicts">[docs]</a>    <span class="k">def</span> <span class="nf">QueryConflicts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries conflicts in a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Conflicts.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="s1">&#39;conflicts&#39;</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;conflicts&#39;</span><span class="p">,</span>
                                    <span class="n">collection_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Conflicts&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadConflict"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadConflict">[docs]</a>    <span class="k">def</span> <span class="nf">ReadConflict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conflict_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a conflict.</span>

<span class="sd">        :param str conflict_link:</span>
<span class="sd">            The link to the conflict.</span>
<span class="sd">        :param dict options:</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Conflict.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">conflict_link</span><span class="p">)</span>
        <span class="n">conflict_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">conflict_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                         <span class="s1">&#39;conflicts&#39;</span><span class="p">,</span>
                         <span class="n">conflict_id</span><span class="p">,</span>
                         <span class="kc">None</span><span class="p">,</span>
                         <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteCollection"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteCollection">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteCollection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a collection.</span>

<span class="sd">        :param str collection_link:</span>
<span class="sd">            The link to the document collection.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Collection.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;colls&#39;</span><span class="p">,</span>
                                   <span class="n">collection_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceDocument"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceDocument">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">new_document</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a document and returns it.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param dict new_document:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The new Document.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">new_document</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="n">document_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        
        <span class="c1"># Pythons default arguments are evaluated once when the function is defined, not each time the function is called (like it is in say, Ruby). </span>
        <span class="c1"># This means that if you use a mutable default argument and mutate it, you will and have mutated that object for all future calls to the function as well.</span>
        <span class="c1"># So, using a non-mutable deafult in this case(None) and assigning an empty dict(mutable) inside the function so that it remains local</span>
        <span class="c1"># For more details on this gotcha, please refer http://docs.python-guide.org/en/latest/writing/gotchas/</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Extract the document collection link and add the partition key to options</span>
        <span class="n">collection_link</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetDocumentCollectionLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AddPartitionKey</span><span class="p">(</span><span class="n">collection_link</span><span class="p">,</span> <span class="n">new_document</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">new_document</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                            <span class="n">document_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteDocument"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteDocument">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a document.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Document.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="n">document_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                                   <span class="n">document_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.CreateAttachment"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateAttachment">[docs]</a>    <span class="k">def</span> <span class="nf">CreateAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates an attachment in a document.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param dict attachment:</span>
<span class="sd">            The Azure Cosmos DB attachment to create.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created Attachment.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">document_id</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetDocumentIdWithPathForAttachment</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span> <span class="n">document_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                           <span class="n">document_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertAttachment"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertAttachment">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts an attachment in a document.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param dict attachment:</span>
<span class="sd">            The Azure Cosmos DB attachment to upsert.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted Attachment.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">document_id</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetDocumentIdWithPathForAttachment</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span> <span class="n">document_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                           <span class="n">document_id</span><span class="p">,</span>
                           <span class="kc">None</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_GetDocumentIdWithPathForAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="n">document_link</span><span class="p">):</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">,</span> <span class="s1">&#39;attachments&#39;</span><span class="p">)</span>
        <span class="n">document_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">document_id</span><span class="p">,</span> <span class="n">path</span>

<div class="viewcode-block" id="DocumentClient.CreateAttachmentAndUploadMedia"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.CreateAttachmentAndUploadMedia">[docs]</a>    <span class="k">def</span> <span class="nf">CreateAttachmentAndUploadMedia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                       <span class="n">document_link</span><span class="p">,</span>
                                       <span class="n">readable_stream</span><span class="p">,</span>
                                       <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates an attachment and upload media.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param (file-like stream object) readable_stream: </span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created Attachment.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">document_id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetDocumentIdWithPathForAttachmentMedia</span><span class="p">(</span><span class="n">document_link</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">readable_stream</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                           <span class="n">document_id</span><span class="p">,</span>
                           <span class="n">initial_headers</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.UpsertAttachmentAndUploadMedia"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpsertAttachmentAndUploadMedia">[docs]</a>    <span class="k">def</span> <span class="nf">UpsertAttachmentAndUploadMedia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                       <span class="n">document_link</span><span class="p">,</span>
                                       <span class="n">readable_stream</span><span class="p">,</span>
                                       <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts an attachment and upload media.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param (file-like stream object) readable_stream:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted Attachment.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">document_id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetDocumentIdWithPathForAttachmentMedia</span><span class="p">(</span><span class="n">document_link</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsert</span><span class="p">(</span><span class="n">readable_stream</span><span class="p">,</span>
                           <span class="n">path</span><span class="p">,</span>
                           <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                           <span class="n">document_id</span><span class="p">,</span>
                           <span class="n">initial_headers</span><span class="p">,</span>
                           <span class="n">options</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_GetDocumentIdWithPathForAttachmentMedia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">initial_headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span><span class="p">)</span>
        
        <span class="c1"># Add required headers slug and content-type.</span>
        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">):</span>
            <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">Slug</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contentType&#39;</span><span class="p">):</span>
            <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ContentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">options</span><span class="p">[</span><span class="s1">&#39;contentType&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ContentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">runtime_constants</span><span class="o">.</span><span class="n">MediaTypes</span><span class="o">.</span><span class="n">OctetStream</span><span class="p">)</span>
        
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">,</span> <span class="s1">&#39;attachments&#39;</span><span class="p">)</span>
        <span class="n">document_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">document_id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">path</span>


<div class="viewcode-block" id="DocumentClient.ReadAttachment"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadAttachment">[docs]</a>    <span class="k">def</span> <span class="nf">ReadAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads an attachment.</span>

<span class="sd">        :param str attachment_link:</span>
<span class="sd">            The link to the attachment.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Attachment.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">attachment_link</span><span class="p">)</span>
        <span class="n">attachment_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">attachment_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                         <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                         <span class="n">attachment_id</span><span class="p">,</span>
                         <span class="kc">None</span><span class="p">,</span>
                         <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadAttachments"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadAttachments">[docs]</a>    <span class="k">def</span> <span class="nf">ReadAttachments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all attachments in a document.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Attachments.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryAttachments</span><span class="p">(</span><span class="n">document_link</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryAttachments"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryAttachments">[docs]</a>    <span class="k">def</span> <span class="nf">QueryAttachments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document_link</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries attachments in a document.</span>

<span class="sd">        :param str document_link:</span>
<span class="sd">            The link to the document.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Attachments.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">,</span> <span class="s1">&#39;attachments&#39;</span><span class="p">)</span>
        <span class="n">document_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">document_link</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                    <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                                    <span class="n">document_id</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Attachments&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>


<div class="viewcode-block" id="DocumentClient.ReadMedia"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadMedia">[docs]</a>    <span class="k">def</span> <span class="nf">ReadMedia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">media_link</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a media.</span>

<span class="sd">        When self.connection_policy.MediaReadMode ==</span>
<span class="sd">        documents.MediaReadMode.Streamed, returns a file-like stream object;</span>
<span class="sd">        otherwise, returns a str.</span>

<span class="sd">        :param str media_link:</span>
<span class="sd">            The link to the media.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Media.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            str or file-like stream object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span>
        <span class="c1"># ReadMedia will always use WriteEndpoint since it&#39;s not replicated in readable Geo regions</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">media_link</span><span class="p">)</span>
        <span class="n">media_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">media_link</span><span class="p">)</span>
        <span class="n">attachment_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetAttachmentIdFromMediaId</span><span class="p">(</span><span class="n">media_id</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">default_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;get&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="n">attachment_id</span><span class="p">,</span>
                                  <span class="s1">&#39;media&#39;</span><span class="p">,</span>
                                  <span class="p">{})</span>

        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Get</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DocumentClient.UpdateMedia"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.UpdateMedia">[docs]</a>    <span class="k">def</span> <span class="nf">UpdateMedia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">media_link</span><span class="p">,</span> <span class="n">readable_stream</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates a media and returns it.</span>

<span class="sd">        :param str media_link:</span>
<span class="sd">            The link to the media.</span>
<span class="sd">        :param (file-like stream object) readable_stream:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The updated Media.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            str or file-like stream object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span><span class="p">)</span>

        <span class="c1"># Add required headers slug and content-type in case the body is a stream</span>
        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">):</span>
            <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">Slug</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contentType&#39;</span><span class="p">):</span>
            <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ContentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">options</span><span class="p">[</span><span class="s1">&#39;contentType&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ContentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">runtime_constants</span><span class="o">.</span><span class="n">MediaTypes</span><span class="o">.</span><span class="n">OctetStream</span><span class="p">)</span>

        <span class="c1"># UpdateMedia will use WriteEndpoint since it uses PUT operation</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">media_link</span><span class="p">)</span>
        <span class="n">media_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">media_link</span><span class="p">)</span>
        <span class="n">attachment_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetAttachmentIdFromMediaId</span><span class="p">(</span><span class="n">media_id</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;put&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="n">attachment_id</span><span class="p">,</span>
                                  <span class="s1">&#39;media&#39;</span><span class="p">,</span>
                                  <span class="n">options</span><span class="p">)</span>

        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Put</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="n">readable_stream</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_UpdateSessionIfRequired</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceAttachment"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceAttachment">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment_link</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces an attachment and returns it.</span>

<span class="sd">        :param str attachment_link:</span>
<span class="sd">            The link to the attachment.</span>
<span class="sd">        :param dict attachment:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The replaced Attachment</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">attachment_link</span><span class="p">)</span>
        <span class="n">attachment_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">attachment_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                            <span class="n">attachment_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteAttachment"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteAttachment">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes an attachment.</span>

<span class="sd">        :param str attachment_link:</span>
<span class="sd">            The link to the attachment.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Attachment.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">attachment_link</span><span class="p">)</span>
        <span class="n">attachment_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">attachment_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;attachments&#39;</span><span class="p">,</span>
                                   <span class="n">attachment_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceTrigger"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceTrigger">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_link</span><span class="p">,</span> <span class="n">trigger</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a trigger and returns it.</span>

<span class="sd">        :param str trigger_link:</span>
<span class="sd">            The link to the trigger.</span>
<span class="sd">        :param dict trigger:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The replaced Trigger.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">trigger</span><span class="p">)</span>
        <span class="n">trigger</span> <span class="o">=</span> <span class="n">trigger</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">trigger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">):</span>
            <span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;serverScript&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">trigger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">):</span>
            <span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">trigger</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">])</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">trigger_link</span><span class="p">)</span>
        <span class="n">trigger_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">trigger_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">trigger</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;triggers&#39;</span><span class="p">,</span>
                            <span class="n">trigger_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteTrigger"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteTrigger">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteTrigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a trigger.</span>

<span class="sd">        :param str trigger_link:</span>
<span class="sd">            The link to the trigger.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Trigger.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">trigger_link</span><span class="p">)</span>
        <span class="n">trigger_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">trigger_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;triggers&#39;</span><span class="p">,</span>
                                   <span class="n">trigger_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceUserDefinedFunction"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceUserDefinedFunction">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceUserDefinedFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">udf_link</span><span class="p">,</span> <span class="n">udf</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a user defined function and returns it.</span>

<span class="sd">        :param str udf_link:</span>
<span class="sd">            The link to the user defined function.</span>
<span class="sd">        :param dict udf:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The new UDF.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">udf</span><span class="p">)</span>
        <span class="n">udf</span> <span class="o">=</span> <span class="n">udf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">udf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">):</span>
            <span class="n">udf</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">udf</span><span class="p">[</span><span class="s1">&#39;serverScript&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">udf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">):</span>
            <span class="n">udf</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">udf</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">])</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">udf_link</span><span class="p">)</span>
        <span class="n">udf_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">udf_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">udf</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;udfs&#39;</span><span class="p">,</span>
                            <span class="n">udf_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteUserDefinedFunction"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteUserDefinedFunction">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteUserDefinedFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">udf_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a user defined function.</span>

<span class="sd">        :param str udf_link:</span>
<span class="sd">            The link to the user defined function.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted UDF.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">udf_link</span><span class="p">)</span>
        <span class="n">udf_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">udf_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;udfs&#39;</span><span class="p">,</span>
                                   <span class="n">udf_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ExecuteStoredProcedure"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ExecuteStoredProcedure">[docs]</a>    <span class="k">def</span> <span class="nf">ExecuteStoredProcedure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sproc_link</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Executes a store procedure.</span>

<span class="sd">        :param str sproc_link:</span>
<span class="sd">            The link to the stored procedure.</span>
<span class="sd">        :param dict params:</span>
<span class="sd">            List or None</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The Stored Procedure response.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span><span class="p">)</span>
        <span class="n">initial_headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">Accept</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">runtime_constants</span><span class="o">.</span><span class="n">MediaTypes</span><span class="o">.</span><span class="n">Json</span><span class="p">)</span>
        <span class="p">})</span>

        <span class="k">if</span> <span class="n">params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">params</span><span class="p">]</span>

        <span class="c1"># ExecuteStoredProcedure will use WriteEndpoint since it uses POST operation</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="n">sproc_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;post&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="n">sproc_id</span><span class="p">,</span>
                                  <span class="s1">&#39;sprocs&#39;</span><span class="p">,</span>
                                  <span class="n">options</span><span class="p">)</span>

        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Post</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                         <span class="n">path</span><span class="p">,</span>
                                                         <span class="n">params</span><span class="p">,</span>
                                                         <span class="n">headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceStoredProcedure"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceStoredProcedure">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceStoredProcedure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sproc_link</span><span class="p">,</span> <span class="n">sproc</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a stored procedure and returns it.</span>

<span class="sd">        :param str sproc_link:</span>
<span class="sd">            The link to the stored procedure.</span>
<span class="sd">        :param dict sproc:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The replaced Stored Procedure.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">sproc</span><span class="p">)</span>
        <span class="n">sproc</span> <span class="o">=</span> <span class="n">sproc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sproc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serverScript&#39;</span><span class="p">):</span>
            <span class="n">sproc</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sproc</span><span class="p">[</span><span class="s1">&#39;serverScript&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">sproc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">):</span>
            <span class="n">sproc</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sproc</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">])</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="n">sproc_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">sproc</span><span class="p">,</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="s1">&#39;sprocs&#39;</span><span class="p">,</span>
                            <span class="n">sproc_id</span><span class="p">,</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteStoredProcedure"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteStoredProcedure">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteStoredProcedure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sproc_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a stored procedure.</span>

<span class="sd">        :param str sproc_link:</span>
<span class="sd">            The link to the stored procedure.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Stored Procedure.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="n">sproc_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">sproc_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;sprocs&#39;</span><span class="p">,</span>
                                   <span class="n">sproc_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteConflict"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteConflict">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteConflict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conflict_link</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a conflict.</span>

<span class="sd">        :param str conflict_link:</span>
<span class="sd">            The link to the conflict.</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Conflict.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">conflict_link</span><span class="p">)</span>
        <span class="n">conflict_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">conflict_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DeleteResource</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                   <span class="s1">&#39;conflicts&#39;</span><span class="p">,</span>
                                   <span class="n">conflict_id</span><span class="p">,</span>
                                   <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReplaceOffer"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReplaceOffer">[docs]</a>    <span class="k">def</span> <span class="nf">ReplaceOffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offer_link</span><span class="p">,</span> <span class="n">offer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces an offer and returns it.</span>

<span class="sd">        :param str offer_link:</span>
<span class="sd">            The link to the offer.</span>
<span class="sd">        :param dict offer:</span>

<span class="sd">        :return:</span>
<span class="sd">            The replaced Offer.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DocumentClient</span><span class="o">.</span><span class="n">__ValidateResource</span><span class="p">(</span><span class="n">offer</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">offer_link</span><span class="p">)</span>
        <span class="n">offer_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">offer_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">offer</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="s1">&#39;offers&#39;</span><span class="p">,</span> <span class="n">offer_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.ReadOffer"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadOffer">[docs]</a>    <span class="k">def</span> <span class="nf">ReadOffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offer_link</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads an offer.</span>

<span class="sd">        :param str offer_link:</span>
<span class="sd">            The link to the offer.</span>

<span class="sd">        :return:</span>
<span class="sd">            The read Offer.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetPathFromLink</span><span class="p">(</span><span class="n">offer_link</span><span class="p">)</span>
        <span class="n">offer_id</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetResourceIdOrFullNameFromLink</span><span class="p">(</span><span class="n">offer_link</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;offers&#39;</span><span class="p">,</span> <span class="n">offer_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{})</span></div>

<div class="viewcode-block" id="DocumentClient.ReadOffers"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.ReadOffers">[docs]</a>    <span class="k">def</span> <span class="nf">ReadOffers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads all offers.</span>

<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Offers.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QueryOffers</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.QueryOffers"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryOffers">[docs]</a>    <span class="k">def</span> <span class="nf">QueryOffers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query for all offers.</span>

<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request</span>

<span class="sd">        :return:</span>
<span class="sd">            Query Iterable of Offers.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            query_iterable.QueryIterable</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span> <span class="nf">fetch_fn</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="s1">&#39;/offers&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;offers&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Offers&#39;</span><span class="p">],</span>
                                    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                    <span class="n">query</span><span class="p">,</span>
                                    <span class="n">options</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span>
        <span class="k">return</span> <span class="n">query_iterable</span><span class="o">.</span><span class="n">QueryIterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">fetch_fn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DocumentClient.GetDatabaseAccount"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.GetDatabaseAccount">[docs]</a>    <span class="k">def</span> <span class="nf">GetDatabaseAccount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_connection</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets database account info.</span>

<span class="sd">        :return:</span>
<span class="sd">            The Database Account.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            documents.DatabaseAccount</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">url_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url_connection</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;get&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="c1"># path</span>
                                  <span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="c1"># id</span>
                                  <span class="s1">&#39;&#39;</span><span class="p">,</span>  <span class="c1"># type</span>
                                  <span class="p">{});</span>
        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Get</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                        <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="p">)</span>
        <span class="n">database_account</span> <span class="o">=</span> <span class="n">documents</span><span class="o">.</span><span class="n">DatabaseAccount</span><span class="p">()</span>
        <span class="n">database_account</span><span class="o">.</span><span class="n">DatabasesLink</span> <span class="o">=</span> <span class="s1">&#39;/dbs/&#39;</span>
        <span class="n">database_account</span><span class="o">.</span><span class="n">MediaLink</span> <span class="o">=</span> <span class="s1">&#39;/media/&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">MaxMediaStorageUsageInMB</span> <span class="ow">in</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">):</span>
            <span class="n">database_account</span><span class="o">.</span><span class="n">MaxMediaStorageUsageInMB</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">[</span>
                    <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">MaxMediaStorageUsageInMB</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">CurrentMediaStorageUsageInMB</span> <span class="ow">in</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">):</span>
            <span class="n">database_account</span><span class="o">.</span><span class="n">CurrentMediaStorageUsageInMB</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">[</span>
                    <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">CurrentMediaStorageUsageInMB</span><span class="p">])</span>
        <span class="n">database_account</span><span class="o">.</span><span class="n">ConsistencyPolicy</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">_Constants</span><span class="o">.</span><span class="n">UserConsistencyPolicy</span><span class="p">)</span>

        <span class="c1"># WritableLocations and ReadableLocations fields will be available only for geo-replicated database accounts</span>
        <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">_Constants</span><span class="o">.</span><span class="n">WritableLocations</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">database_account</span><span class="o">.</span><span class="n">_WritableLocations</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">_Constants</span><span class="o">.</span><span class="n">WritableLocations</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">_Constants</span><span class="o">.</span><span class="n">ReadableLocations</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">database_account</span><span class="o">.</span><span class="n">_ReadableLocations</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">_Constants</span><span class="o">.</span><span class="n">ReadableLocations</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">database_account</span></div>

<div class="viewcode-block" id="DocumentClient.Create"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.Create">[docs]</a>    <span class="k">def</span> <span class="nf">Create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a Azure Cosmos DB resource and returns it.</span>

<span class="sd">        :param dict body:</span>
<span class="sd">        :param str path:</span>
<span class="sd">        :param str type:</span>
<span class="sd">        :param str id:</span>
<span class="sd">        :param dict initial_headers:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The created Azure Cosmos DB resource.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="n">initial_headers</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;post&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="nb">id</span><span class="p">,</span>
                                  <span class="nb">type</span><span class="p">,</span>
                                  <span class="n">options</span><span class="p">)</span>
        <span class="c1"># Create will use WriteEndpoint since it uses POST operation</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>
        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Post</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                         <span class="n">path</span><span class="p">,</span>
                                                         <span class="n">body</span><span class="p">,</span>
                                                         <span class="n">headers</span><span class="p">)</span>

        <span class="c1"># update session for write request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_UpdateSessionIfRequired</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DocumentClient.Upsert"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.Upsert">[docs]</a>    <span class="k">def</span> <span class="nf">Upsert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upserts a Azure Cosmos DB resource and returns it.</span>
<span class="sd">        </span>
<span class="sd">        :param dict body:</span>
<span class="sd">        :param str path:</span>
<span class="sd">        :param str type:</span>
<span class="sd">        :param str id:</span>
<span class="sd">        :param dict initial_headers:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted Azure Cosmos DB resource.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="n">initial_headers</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;post&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="nb">id</span><span class="p">,</span>
                                  <span class="nb">type</span><span class="p">,</span>
                                  <span class="n">options</span><span class="p">)</span>

        <span class="n">headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">IsUpsert</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Upsert will use WriteEndpoint since it uses POST operation</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>
        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Post</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                         <span class="n">path</span><span class="p">,</span>
                                                         <span class="n">body</span><span class="p">,</span>
                                                         <span class="n">headers</span><span class="p">)</span>
        <span class="c1"># update session for write request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_UpdateSessionIfRequired</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DocumentClient.Replace"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.Replace">[docs]</a>    <span class="k">def</span> <span class="nf">Replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replaces a Azure Cosmos DB resource and returns it.</span>

<span class="sd">        :param dict resource:</span>
<span class="sd">        :param str path:</span>
<span class="sd">        :param str type:</span>
<span class="sd">        :param str id:</span>
<span class="sd">        :param dict initial_headers:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The new Azure Cosmos DB resource.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="n">initial_headers</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;put&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="nb">id</span><span class="p">,</span>
                                  <span class="nb">type</span><span class="p">,</span>
                                  <span class="n">options</span><span class="p">)</span>
        <span class="c1"># Replace will use WriteEndpoint since it uses PUT operation</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>
        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Put</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="n">resource</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="p">)</span>
        
        <span class="c1"># update session for request mutates data on server side</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_UpdateSessionIfRequired</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DocumentClient.Read"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.Read">[docs]</a>    <span class="k">def</span> <span class="nf">Read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads a Azure Cosmos DB resource and returns it.</span>

<span class="sd">        :param str path:</span>
<span class="sd">        :param str type:</span>
<span class="sd">        :param str id:</span>
<span class="sd">        :param dict initial_headers:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The upserted Azure Cosmos DB resource.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="n">initial_headers</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;get&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="nb">id</span><span class="p">,</span>
                                  <span class="nb">type</span><span class="p">,</span>
                                  <span class="n">options</span><span class="p">)</span>
        <span class="c1"># Read will use ReadEndpoint since it uses GET operation</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">ReadEndpoint</span>
        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Get</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DocumentClient.DeleteResource"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.DeleteResource">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteResource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">initial_headers</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a Azure Cosmos DB resource and returns it.</span>

<span class="sd">        :param str path:</span>
<span class="sd">        :param str type:</span>
<span class="sd">        :param str id:</span>
<span class="sd">        :param dict initial_headers:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>

<span class="sd">        :return:</span>
<span class="sd">            The deleted Azure Cosmos DB resource.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="n">initial_headers</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">initial_headers</span><span class="p">,</span>
                                  <span class="s1">&#39;delete&#39;</span><span class="p">,</span>
                                  <span class="n">path</span><span class="p">,</span>
                                  <span class="nb">id</span><span class="p">,</span>
                                  <span class="nb">type</span><span class="p">,</span>
                                  <span class="n">options</span><span class="p">)</span>
        <span class="c1"># Delete will use WriteEndpoint since it uses DELETE operation</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">WriteEndpoint</span>
        <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Delete</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                           <span class="n">path</span><span class="p">,</span>
                                                           <span class="n">headers</span><span class="p">)</span>

        <span class="c1"># update session for request mutates data on server side</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_UpdateSessionIfRequired</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">result</span></div>

    <span class="k">def</span> <span class="nf">__Get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Azure Cosmos DB &#39;GET&#39; http request.</span>

<span class="sd">        :params str url:</span>
<span class="sd">        :params str path:</span>
<span class="sd">        :params dict headers:</span>

<span class="sd">        :return:</span>
<span class="sd">            Tuple of (result, headers).</span>
<span class="sd">        :rtype:</span>
<span class="sd">            tuple of (dict, dict)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">synchronized_request</span><span class="o">.</span><span class="n">SynchronizedRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">connection_policy</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_requests_session</span><span class="p">,</span>
                                                        <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
                                                        <span class="n">url</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="kc">None</span><span class="p">,</span>
                                                        <span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__Post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Azure Cosmos DB &#39;POST&#39; http request.</span>

<span class="sd">        :params str url:</span>
<span class="sd">        :params str path:</span>
<span class="sd">        :params (str, unicode, dict) body:</span>
<span class="sd">        :params dict headers:</span>

<span class="sd">        :return:</span>
<span class="sd">            Tuple of (result, headers).</span>
<span class="sd">        :rtype:</span>
<span class="sd">            tuple of (dict, dict)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">synchronized_request</span><span class="o">.</span><span class="n">SynchronizedRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">connection_policy</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_requests_session</span><span class="p">,</span>
                                                        <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
                                                        <span class="n">url</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="n">body</span><span class="p">,</span>
                                                        <span class="n">query_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__Put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Azure Cosmos DB &#39;PUT&#39; http request.</span>

<span class="sd">        :params str url:</span>
<span class="sd">        :params str path:</span>
<span class="sd">        :params (str, unicode, dict) body:</span>
<span class="sd">        :params dict headers:</span>

<span class="sd">        :return:</span>
<span class="sd">            Tuple of (result, headers).</span>
<span class="sd">        :rtype:</span>
<span class="sd">            tuple of (dict, dict)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">synchronized_request</span><span class="o">.</span><span class="n">SynchronizedRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">connection_policy</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_requests_session</span><span class="p">,</span>
                                                        <span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
                                                        <span class="n">url</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="n">body</span><span class="p">,</span>
                                                        <span class="n">query_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__Delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Azure Cosmos DB &#39;DELETE&#39; http request.</span>

<span class="sd">        :params str url:</span>
<span class="sd">        :params str path:</span>
<span class="sd">        :params dict headers:</span>

<span class="sd">        :return:</span>
<span class="sd">            Tuple of (result, headers).</span>
<span class="sd">        :rtype:</span>
<span class="sd">            tuple of (dict, dict)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">synchronized_request</span><span class="o">.</span><span class="n">SynchronizedRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">connection_policy</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_requests_session</span><span class="p">,</span>
                                                        <span class="s1">&#39;DELETE&#39;</span><span class="p">,</span>
                                                        <span class="n">url</span><span class="p">,</span>
                                                        <span class="n">path</span><span class="p">,</span>
                                                        <span class="n">request_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">query_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<div class="viewcode-block" id="DocumentClient.QueryFeed"><a class="viewcode-back" href="../../api/pydocumentdb.document_client.html#pydocumentdb.document_client.DocumentClient.QueryFeed">[docs]</a>    <span class="k">def</span> <span class="nf">QueryFeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">partition_key_range_id</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query Feed for Document Collection resource.</span>

<span class="sd">        :param str path:</span>
<span class="sd">            Path to the document collection.</span>
<span class="sd">        :param str collection_id:</span>
<span class="sd">            Id of the document collection.</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>
<span class="sd">        :param str partition_key_range_id:</span>
<span class="sd">            Partition key range id.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            tuple</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__QueryFeed</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                                <span class="n">collection_id</span><span class="p">,</span>
                                <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;Documents&#39;</span><span class="p">],</span>
                                <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
                                <span class="n">query</span><span class="p">,</span>
                                <span class="n">options</span><span class="p">,</span>
                                <span class="n">partition_key_range_id</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span></div>
    
    <span class="k">def</span> <span class="nf">__QueryFeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">path</span><span class="p">,</span>
                    <span class="nb">type</span><span class="p">,</span>
                    <span class="nb">id</span><span class="p">,</span>
                    <span class="n">result_fn</span><span class="p">,</span>
                    <span class="n">create_fn</span><span class="p">,</span>
                    <span class="n">query</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">partition_key_range_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query for more than one Azure Cosmos DB resources.</span>

<span class="sd">        :param str path:</span>
<span class="sd">        :param str type:</span>
<span class="sd">        :param str id:</span>
<span class="sd">        :param function result_fn:</span>
<span class="sd">        :param function create_fn:</span>
<span class="sd">        :param (str or dict) query:</span>
<span class="sd">        :param dict options:</span>
<span class="sd">            The request options for the request.</span>
<span class="sd">        :param str partition_key_range_id:</span>
<span class="sd">            Specifies partition key range id.</span>

<span class="sd">        :rtype:</span>
<span class="sd">            list</span>
<span class="sd">        </span>
<span class="sd">        :raises SystemError: If the query compatibility mode is undefined.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
            <span class="n">__GetBodiesFromQueryResult</span> <span class="o">=</span> <span class="n">result_fn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">__GetBodiesFromQueryResult</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">create_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span> <span class="k">for</span> <span class="n">body</span> <span class="ow">in</span> <span class="n">result_fn</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span>

        <span class="c1"># Query operations will use ReadEndpoint even though it uses GET(for feed requests) and POST(for regular query operations)</span>
        <span class="n">url_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_endpoint_manager</span><span class="o">.</span><span class="n">ReadEndpoint</span>

        <span class="n">initial_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_headers</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Copy to make sure that default_headers won&#39;t be changed.</span>
        <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="n">initial_headers</span><span class="p">,</span>
                                      <span class="s1">&#39;get&#39;</span><span class="p">,</span>
                                      <span class="n">path</span><span class="p">,</span>
                                      <span class="nb">id</span><span class="p">,</span>
                                      <span class="nb">type</span><span class="p">,</span>
                                      <span class="n">options</span><span class="p">,</span>
                                      <span class="n">partition_key_range_id</span><span class="p">)</span>
            <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Get</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                            <span class="n">path</span><span class="p">,</span>
                                                            <span class="n">headers</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">__GetBodiesFromQueryResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__CheckAndUnifyQueryFormat</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

            <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">IsQuery</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compatibility_mode</span> <span class="o">==</span> <span class="n">DocumentClient</span><span class="o">.</span><span class="n">_QueryCompatibilityMode</span><span class="o">.</span><span class="n">Default</span> <span class="ow">or</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_query_compatibility_mode</span> <span class="o">==</span> <span class="n">DocumentClient</span><span class="o">.</span><span class="n">_QueryCompatibilityMode</span><span class="o">.</span><span class="n">Query</span><span class="p">):</span>
                <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ContentType</span><span class="p">]</span> <span class="o">=</span> <span class="n">runtime_constants</span><span class="o">.</span><span class="n">MediaTypes</span><span class="o">.</span><span class="n">QueryJson</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compatibility_mode</span> <span class="o">==</span> <span class="n">DocumentClient</span><span class="o">.</span><span class="n">_QueryCompatibilityMode</span><span class="o">.</span><span class="n">SqlQuery</span><span class="p">:</span>
                <span class="n">initial_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ContentType</span><span class="p">]</span> <span class="o">=</span> <span class="n">runtime_constants</span><span class="o">.</span><span class="n">MediaTypes</span><span class="o">.</span><span class="n">SQL</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s1">&#39;Unexpected query compatibility mode.&#39;</span><span class="p">)</span>

            <span class="n">headers</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">GetHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="n">initial_headers</span><span class="p">,</span>
                                      <span class="s1">&#39;post&#39;</span><span class="p">,</span>
                                      <span class="n">path</span><span class="p">,</span>
                                      <span class="nb">id</span><span class="p">,</span>
                                      <span class="nb">type</span><span class="p">,</span>
                                      <span class="n">options</span><span class="p">,</span>
                                      <span class="n">partition_key_range_id</span><span class="p">)</span>
            <span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_response_headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__Post</span><span class="p">(</span><span class="n">url_connection</span><span class="p">,</span>
                                                             <span class="n">path</span><span class="p">,</span>
                                                             <span class="n">query</span><span class="p">,</span>
                                                             <span class="n">headers</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">__GetBodiesFromQueryResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__CheckAndUnifyQueryFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_body</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks and unifies the format of the query body.</span>

<span class="sd">        :raises TypeError: If query_body is not of expected type (depending on the query compatibility mode).</span>
<span class="sd">        :raises ValueError: If query_body is a dict but doesn\&#39;t have valid query text.</span>
<span class="sd">        :raises SystemError: If the query compatibility mode is undefined.</span>

<span class="sd">        :param (str or dict) query_body:</span>

<span class="sd">        :return:</span>
<span class="sd">            The formatted query body.</span>
<span class="sd">        :rtype:</span>
<span class="sd">            dict or string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compatibility_mode</span> <span class="o">==</span> <span class="n">DocumentClient</span><span class="o">.</span><span class="n">_QueryCompatibilityMode</span><span class="o">.</span><span class="n">Default</span> <span class="ow">or</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">_query_compatibility_mode</span> <span class="o">==</span> <span class="n">DocumentClient</span><span class="o">.</span><span class="n">_QueryCompatibilityMode</span><span class="o">.</span><span class="n">Query</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_body</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_body</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;query body must be a dict or string.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_body</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">query_body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;query&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;query body must have valid query text with key &quot;query&quot;.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_body</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="n">query_body</span><span class="p">}</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compatibility_mode</span> <span class="o">==</span> <span class="n">DocumentClient</span><span class="o">.</span><span class="n">_QueryCompatibilityMode</span><span class="o">.</span><span class="n">SqlQuery</span> <span class="ow">and</span>
              <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query_body</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;query body must be a string.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s1">&#39;Unexpected query compatibility mode.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">query_body</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__ValidateResource</span><span class="p">(</span><span class="n">resource</span><span class="p">):</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">id</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">id</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">id</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">id</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">id</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Id contains illegal chars.&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">id</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Id ends with a space.&#39;</span><span class="p">)</span>

    <span class="c1"># Adds the partition key to options</span>
    <span class="k">def</span> <span class="nf">_AddPartitionKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_link</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">collection_link</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">TrimBeginningAndEndingSlashes</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        
        <span class="c1">#TODO: Refresh the cache if partition is extracted automatically and we get a 400.1001</span>

        <span class="c1"># If the document collection link is present in the cache, then use the cached partitionkey definition</span>
        <span class="k">if</span> <span class="n">collection_link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">partition_key_definition_cache</span><span class="p">:</span>
            <span class="n">partitionKeyDefinition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">partition_key_definition_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
        <span class="c1"># Else read the collection from backend and add it to the cache</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadCollection</span><span class="p">(</span><span class="n">collection_link</span><span class="p">)</span>
            <span class="n">partitionKeyDefinition</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;partitionKey&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">partition_key_definition_cache</span><span class="p">[</span><span class="n">collection_link</span><span class="p">]</span> <span class="o">=</span> <span class="n">partitionKeyDefinition</span>
        
        <span class="c1"># If the collection doesn&#39;t have a partition key definition, skip it as it&#39;s a legacy collection </span>
        <span class="k">if</span> <span class="n">partitionKeyDefinition</span><span class="p">:</span>
            <span class="c1"># If the user has passed in the partitionKey in options use that elase extract it from the document</span>
            <span class="k">if</span><span class="p">(</span><span class="s1">&#39;partitionKey&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">):</span>
                <span class="n">partitionKeyValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ExtractPartitionKey</span><span class="p">(</span><span class="n">partitionKeyDefinition</span><span class="p">,</span> <span class="n">document</span><span class="p">)</span>
                <span class="n">options</span><span class="p">[</span><span class="s1">&#39;partitionKey&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">partitionKeyValue</span>
        
        <span class="k">return</span> <span class="n">options</span>

    <span class="c1"># Extracts the partition key from the document using the partitionKey definition</span>
    <span class="k">def</span> <span class="nf">_ExtractPartitionKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partitionKeyDefinition</span><span class="p">,</span> <span class="n">document</span><span class="p">):</span>

        <span class="c1"># Parses the paths into a list of token each representing a property</span>
        <span class="n">partition_key_parts</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">ParsePaths</span><span class="p">(</span><span class="n">partitionKeyDefinition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;paths&#39;</span><span class="p">))</span>

        <span class="c1"># Navigates the document to retrieve the partitionKey specified in the paths</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RetrievePartitionKey</span><span class="p">(</span><span class="n">partition_key_parts</span><span class="p">,</span> <span class="n">document</span><span class="p">)</span>

    <span class="c1"># Navigates the document to retrieve the partitionKey specified in the partition key parts</span>
    <span class="k">def</span> <span class="nf">_RetrievePartitionKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partition_key_parts</span><span class="p">,</span> <span class="n">document</span><span class="p">):</span>
        <span class="n">expected_matchCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition_key_parts</span><span class="p">)</span>
        <span class="n">matchCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">partitionKey</span> <span class="o">=</span> <span class="n">document</span>

        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">partition_key_parts</span><span class="p">:</span>
            <span class="c1"># At any point if we don&#39;t find the value of a sub-property in the document, we return as Undefined</span>
            <span class="k">if</span> <span class="n">part</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">partitionKey</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">documents</span><span class="o">.</span><span class="n">Undefined</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">partitionKey</span> <span class="o">=</span> <span class="n">partitionKey</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                <span class="n">matchCount</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># Once we reach the &quot;leaf&quot; value(not a dict), we break from loop</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">partitionKey</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="k">break</span>

        <span class="c1"># Match the count of hops we did to get the partitionKey with the length of partition key parts and validate that it&#39;s not a dict at that level</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">matchCount</span> <span class="o">!=</span> <span class="n">expected_matchCount</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">partitionKey</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">documents</span><span class="o">.</span><span class="n">Undefined</span>
         
        <span class="k">return</span> <span class="n">partitionKey</span>
    
    <span class="k">def</span> <span class="nf">_UpdateSessionIfRequired</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_headers</span><span class="p">,</span> <span class="n">response_result</span><span class="p">,</span> <span class="n">response_headers</span><span class="p">):</span>    
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates session if necessary.</span>

<span class="sd">        :param dict response_result:</span>
<span class="sd">        :param dict response_headers:</span>
<span class="sd">        :param dict response_headers</span>

<span class="sd">        :return:</span>
<span class="sd">            None, but updates the client session if necessary.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="sd">&#39;&#39;&#39;if this request was made with consistency level as session, then update</span>
<span class="sd">        the session&#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">response_result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">response_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">is_session_consistency</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ConsistencyLevel</span> <span class="ow">in</span> <span class="n">request_headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">documents</span><span class="o">.</span><span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">Session</span> <span class="o">==</span> <span class="n">request_headers</span><span class="p">[</span><span class="n">http_constants</span><span class="o">.</span><span class="n">HttpHeaders</span><span class="o">.</span><span class="n">ConsistencyLevel</span><span class="p">]:</span>
                <span class="n">is_session_consistency</span> <span class="o">=</span> <span class="kc">True</span>
              
        <span class="k">if</span> <span class="n">is_session_consistency</span><span class="p">:</span>
            <span class="c1"># update session</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">update_session</span><span class="p">(</span><span class="n">response_result</span><span class="p">,</span> <span class="n">response_headers</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pydocumentdb 2.3.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Microsoft.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.4.
    </div>
  </body>
</html>